# Классификация эмоций нарисованных персонажей с помощью глубоких нейронных сетей
 ## Решаемая задача
[Набор данных](http://grail.cs.washington.edu/projects/deepexpr/ferg-db.html "dataset description") состоит из изображений лиц 6-ти персонажей. Изображения для каждого персонажа сгруппированы по семи типовым выражениям лица: гнев, отвращение, страх, радость, нейтральное выражение, печаль и удивление. Всего база содержит 55767 изображений лиц шести стилизованных персонажей.

Решалась задача распознавания эмоции персонажа по имеющимся изображениям.

## Тренировочные и тестовые данные
Исходный датасет представлял из себя 55767 цветных изображений размера 256x256 разбитых по 6 папкам - каждому персонажу отведена отдельная папка. Внутри этих папок изображения разбиты ещё на 7 папок по названиям эмоций.

Изображения для тренировочной и тестовой выборок брались из исходной выборки случайным образом, соотношение размеров выборок - 0.8:0.2

## Подготовка данных
Так как решалась задача распознавания эмоций без привязки их к конкрентным персонажам, все изображения были разбиты на 7 папок по названиям эмоций.

Также, для того, чтобы облегчить обучение моделей, было принято решение сжать картинки до разрешения 128x128.
Для обучения моделей с использованием библиотеки MXNet было удобно перевести всю выборку в файлы .rec формата - один файл для тренировочной выборки и один файл для тестовой выборки.

Для перевода выборки в .rec формат использовался скрипт [im2rec.py](https://github.com/apache/incubator-mxnet/blob/master/tools/im2rec.py "im2rec script")

Готовые .rec файлы: [тренировочная выборка](https://drive.google.com/file/d/1V5ah0pdvAz-e0IJwsnM56t_00Qmf1jLH/view "train rec")
[тестовая выборка](https://drive.google.com/file/d/1pVmOwamvBJ15RaImW_kVHlYUNmxPK4Kf/view "test rec")

## Тестовая инфраструктура
Intel® Core™ i5-7200U CPU @ 2.50GHz (2 физ. ядра + 2 вирт.), GeForce 940MX/PCIe/SSE2/2ГБ, 8ГБ RAM

## Установка необходимых библиотек
1. Установить интерпретатор Python версии 2.7.x, который можно скачать с [официального сайта](https://www.python.org/downloads/ "python download") или установить его в составе пакета [Anaconda](https://www.anaconda.com/download/ "Anaconda download")

2. Установить необходимые для работы скриптов пакеты: mxnet, opencv-python. Для этого после установки итерпретатора достаточно написать в командной строке:
<pre><code>pip install mxnet
pip install opencv-python
</code></pre>
